
[x f_sample] = audioread('../angerfist.wav');


N = length(x);
t = N/f_sample;

X = fft(x,N);
% Steps til frekvensaksen
delta_f = f_sample/N;
f_axis = [0:delta_f:f_sample - delta_f];

% Plot af x alene. Her kan man se frekvensspektraet for hver sample;
figure(5);
plot(x)
xlabel('Samples')
ylabel('Amplitude i volt')
title('Sample-plot af signalet')

% Plot energien af X på y-aksen (dvs dft-størrelsen), samt frekvenser der er tilstede hen af
% x-aksen
figure(6)
plot(f_axis(1:0.5*end), abs((2/N)*X(1:0.5*end)))
xlabel('Frekvenser i Herz')
ylabel('Størrelse i Volt')
title('DFT størrelse (magnitude)')
grid on

% Plotter faserne op y-aksen
% Kommandobetegnelser:
% unwrap(): Correct phase angles to produce smoother phase plots
% angle(): tager vinklen af et komplekst datasæt, her DFT
figure(7)
plot(f_axis(1:0.5*end), unwrap(angle(X(1:0.5*end))))
xlabel('Fase')
ylabel('Frekvenser i Hertz')
title('DFT Fase')
grid on

% Størrelsesplot, men nu logaritmisk
figure(8)
semilogx(f_axis(1:0.5*end), 20*log10(abs((2/N)*X(1:0.5*end))))
xlabel('Frekvens i Herz')
ylabel('Størrelse dB rel. 1 Volt')
title('DFT størrelse (magnitude)')
grid on
% x-aksen bliver begrænset fra 10Hz til 1000Hz 
% y-aksen bliver begrænset fra -95 db til -25 db
%axis([10 1000 -95 -25])

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
y = volumen(x,5);

N = length(y);
t = N/f_sample;

X = fft(y,N);
% Steps til frekvensaksen
delta_f = f_sample/N;
f_axis = [0:delta_f:f_sample - delta_f];

% Plot af x alene. Her kan man se frekvensspektraet for hver sample;
figure(5);
plot(y)
xlabel('Samples')
ylabel('Amplitude i volt')
title('Sample-plot af signalet')

% Plot energien af X på y-aksen (dvs dft-størrelsen), samt frekvenser der er tilstede hen af
% x-aksen
figure(6)
plot(f_axis(1:0.5*end), abs((2/N)*X(1:0.5*end)))
xlabel('Frekvenser i Herz')
ylabel('Størrelse i Volt')
title('DFT størrelse (magnitude)')
grid on

% Plotter faserne op y-aksen
% Kommandobetegnelser:
% unwrap(): Correct phase angles to produce smoother phase plots
% angle(): tager vinklen af et komplekst datasæt, her DFT
figure(7)
plot(f_axis(1:0.5*end), unwrap(angle(X(1:0.5*end))))
xlabel('Fase')
ylabel('Frekvenser i Hertz')
title('DFT Fase')
grid on

% Størrelsesplot, men nu logaritmisk
figure(8)
semilogx(f_axis(1:0.5*end), 20*log10(abs((2/N)*X(1:0.5*end))))
xlabel('Frekvens i Herz')
ylabel('Størrelse dB rel. 1 Volt')
title('DFT størrelse (magnitude)')
grid on
% x-aksen bliver begrænset fra 10Hz til 1000Hz 
% y-aksen bliver begrænset fra -95 db til -25 db
%axis([10 1000 -95 -25])